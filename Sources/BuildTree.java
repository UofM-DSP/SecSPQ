package snpLab.UofM;

/**
 * Created by zahidul on 7/28/16.
 */

import AES_CTR.AESCTR;
import GenericTree.GenericTree;
import GenericTree.GenericTreeNode;
import HomomorphicEncryption.Paillier;

import javax.crypto.SecretKey;
import javax.crypto.spec.IvParameterSpec;
import java.io.File;
import java.security.Key;
import java.security.SecureRandom;
import java.security.Security;
import java.sql.Connection;
import java.sql.Statement;
import java.text.DateFormat;
import java.text.SimpleDateFormat;
import java.util.*;

//import org.apache.commons.cli.ParseException;


public class BuildTree {
    static final String JDBC_DRIVER = "com.mysql.jdbc.Driver";
    static final String DB_URL = "jdbc:mysql://localhost/count_query2";

    //  Database credentials
    static final String USER_NAME = "root";
    static final String PASS_WORD = "pco43oca";

    public static Paillier paillier;
    public static AESCTR aesctr;

    Statement st = null;
    Connection conn = null;

    public Map mapSnpToId() {
        Map<String, String> snpIdMap = new HashMap<String, String>();
        snpIdMap.put("A", "000");
        snpIdMap.put("C", "011");
        snpIdMap.put("G", "101");
        snpIdMap.put("T", "110");
        return snpIdMap;
    }

//    public Map mapSnpToId() {
//        Map<String, String> snpIdMap = new HashMap<String, String>();
//        snpIdMap.put("A", "A");
//        snpIdMap.put("C", "C");
//        snpIdMap.put("G", "G");
//        snpIdMap.put("T", "T");
//        return snpIdMap;
//    }

    public GenericTree generateTree(List<String> seqList) {
        GenericTree gt = new GenericTree();
//        GenericTreeNode rootNode = new GenericTreeNode(BigInteger.valueOf(0));
        GenericTreeNode rootNode = new GenericTreeNode("root");
        gt.setRoot(rootNode);

        Map<String, String> snpIdMap = mapSnpToId();

        GenericTreeNode childNode = null;
        Integer id = 0;
        try {
            for (String seq_with_id : seqList) {
                GenericTreeNode parentNode = rootNode;
                parentNode.setLevel(0);
                String[] seq = seq_with_id.split(" ")[0].split("");
                //Integer id = Integer.parseInt(seq_with_id.split(" ")[1]);
                id += 1;
                for (int j = 0; j < seq.length; j++) {
//                    childNode = new GenericTreeNode(BigInteger.valueOf((int)snpIdMap.get(seq[j])));
                    childNode = new GenericTreeNode(snpIdMap.get(seq[j]));
//                    childNode.setDataLength(childNode.getData().length());
//                    childNode = new GenericTreeNode(seq[j]);
                    if (parentNode.hasChildren()) {
                        List<GenericTreeNode> l = parentNode.getChildren();
                        int flag = 0;
                        for (int i = 0; i < l.size(); i++) {
                            GenericTreeNode gtn = l.get(i);
                            if (childNode.getData().equals(gtn.getData())) {
                                //gtn.setcount(gtn.getCount().addGC(BigInteger.valueOf(1)));
                                parentNode = gtn;
                                
                                flag = 1;
                                break;
                            }
                        }
                        if (flag == 0) {
                            //childNode.setSnpID(columnName);
                            parentNode.addChild(childNode);
                            parentNode = childNode;

                        }
                        if(j==seq.length-1){
                            parentNode.setIds(id);
                            parentNode.setLeafNode();
                        }
                    } else {
                        //childNode.setSnpID(columnName);
                        parentNode.addChild(childNode);
                        parentNode = childNode;
                        if(j==seq.length-1){
                            parentNode.setIds(id);
                            parentNode.setLeafNode();
                        }
                    }
                }

            }
        } catch (Exception e) {
            //Handle errors for Class.forName
            e.printStackTrace();
            System.out.println(e.getMessage());
        }
        GenericTree compressedTree = compressTree(gt,rootNode);
       // List<GenericTreeNode> preorder_Node = gt.build(rootNode,PRE_ORDER);

        return compressedTree;
    }

    public GenericTree compressTree(GenericTree gt, GenericTreeNode rootNode){
        //GenericTreeNode parentNode = rootNode;
        int numberOfChild = rootNode.getNumberOfChildren();
        for (int i=0;i<numberOfChild;i++){
            GenericTreeNode currentNode = rootNode.getChildAt(i);
            if(currentNode.getNumberOfChildren() == 1){
                while(currentNode.getNumberOfChildren() == 1){
                    String nodeValue = currentNode.getData();//.toString();
                    GenericTreeNode currentNodeChild = currentNode.getChildAt(0);
                    String childValue = currentNodeChild.getData();//.toString();
                    String newValue = nodeValue+childValue;
//                    BigInteger newVal = new BigInteger(newValue);
//                    currentNodeChild.setData(newVal);
                    currentNodeChild.setData(newValue);
                    currentNodeChild.setDataLength(newValue.length());
                    rootNode.removeChildAt(i);
                    rootNode.addChildAt(i,currentNodeChild);
                    currentNode = currentNodeChild;
                }
                if(currentNode.getNumberOfChildren()>1){
                    compressTree(gt, currentNode);
                }
            }
            else{
                compressTree(gt, currentNode);
            }
        }
        return gt;
    }


    public AESCTR encryptTree(GenericTree gt) throws Exception{
        GenericTree encryptedTree = gt;

        List<GenericTreeNode<GenericTree>> traversalResult = new ArrayList<GenericTreeNode<GenericTree>>();
        Queue a = new LinkedList();
        GenericTreeNode root = encryptedTree.getRoot();
        int count = 0;
        Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());
        SecureRandom random = new SecureRandom();
        Key key = aesctr.createKeyForAES(256, random);
        aesctr = new AESCTR();

        if(root != null) {
            traversalResult = root.getChildren();
            for (GenericTreeNode node:traversalResult) {
                a.add(node);
                count++;
            }


            while(!a.isEmpty()) {
                GenericTreeNode node= (GenericTreeNode) a.remove();

                //encrypt data
               /* Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());
                SecureRandom random = new SecureRandom();*/
                IvParameterSpec ivSpec = aesctr.createCtrIvForAES(1, random);
                //Key key = aesctr.createKeyForAES(256, random);
                //String plainText = node.getData();
                SecretKey secKey = aesctr.createKeyForAES(1, random);

                //byte[] cipherText = aesctr.encryptText(plainText, secKey, ivSpec);
                //String decryptedText = aesctr.decryptText(cipherText, secKey, ivSpec);
                //node.setData(aesctr.bytesToHex(cipherText));


                traversalResult = node.getChildren();

                for (GenericTreeNode n:traversalResult) {
                    a.add(n);
                    count++;
                }
            }
        }
        return aesctr;

    }

    public GenericTree encryptTree_(GenericTree gt) throws Exception{
        GenericTree encryptedTree = gt;

        List<GenericTreeNode<GenericTree>> traversalResult = new ArrayList<GenericTreeNode<GenericTree>>();
        Queue a = new LinkedList();
        GenericTreeNode root = encryptedTree.getRoot();
        int count = 0;
        Security.addProvider(new org.bouncycastle.jce.provider.BouncyCastleProvider());
        SecureRandom random = new SecureRandom();
        Key key = aesctr.createKeyForAES(256, random);
        //aesctr = new AESCTR();

        if(root != null) {
            traversalResult = root.getChildren();
            for (GenericTreeNode node:traversalResult) {
                a.add(node);
                count++;
            }


            while(!a.isEmpty()) {
                GenericTreeNode node= (GenericTreeNode) a.remove();

                //encrypt data
//                IvParameterSpec ivSpec = aesctr.createCtrIvForAES(1, random);
                //Key key = aesctr.createKeyForAES(256, random);
                String binarySNPsequence = node.getData();
//                SecretKey secKey = aesctr.createKeyForAES(1, random);
//                Random rand = new Random();
//                int random_number = rand.nextInt(10000);
//                String nonce = Integer.toString(random_number);
//                byte[] cipherText = aesctr.encryptText(nonce, secKey, ivSpec);
//                BigInteger keyStream = new BigInteger(aesctr.bytesToHex(cipherText), 16);
//                String strKey = "101110011011010101101110011011010101101110011011010101101110";
//                String strKey = "101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100";
                String strKey = "101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100";
//                String strKey = "101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011";
//                String strKey = "101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110";
//                String strKey = "101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011101011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100110110101011011100";
//                String strKey = "101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110";
//                String strKey = "101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110011011010101101110";
                //System.out.println("Input 2: keystream: " + keyStream);
                StringBuilder encryptedSNPsequence = new StringBuilder();
                for(int i = 0; i < strKey.length(); i++)
                    encryptedSNPsequence.append((char)(strKey.charAt(i) ^ binarySNPsequence.charAt(i % binarySNPsequence.length())));
                String encryptedResult = encryptedSNPsequence.toString();
                //System.out.println("After XOR" + encryptedResult + "-------" + encryptedResult.length());

//                BigInteger encryptedVal = plainText.xor(keyStream);
                //System.out.println("Encrypted value: " + encryptedVal);
//                node.setData(encryptedVal);
                node.setDataLength(binarySNPsequence.length());
                node.setData(encryptedResult);
//                node.setKeystream(keyStream);
                //node.setData("");

                traversalResult = node.getChildren();

                for (GenericTreeNode n:traversalResult) {
                    a.add(n);
                    count++;
                }
            }
        }
        return encryptedTree;

    }

    public static void main(String [] args) throws ClassNotFoundException, InstantiationException, IllegalAccessException{
        BuildTree bt = new BuildTree();
        List<String> seqList = new ArrayList();
        DateFormat dateFormat = new SimpleDateFormat("yyyy/MM/dd HH:mm:ss");
        Date date = new Date();
        try {
            //Scanner fileScanner = new Scanner(new File("SyntheticDataFull.txt"));
            Scanner fileScanner = new Scanner(new File("test_data.txt"));
            while (fileScanner.hasNextLine()){
                seqList.add(fileScanner.nextLine());
            }
            fileScanner.close();

        } catch (Exception ex) {
            ex.printStackTrace();
        }
        Date date1 = new Date();
        System.out.println("Data fetching Time: " + (date1.getTime() - date.getTime()));
        //System.out.println(" Elements");
        //System.out.print(seqList);
        date = new Date();
        GenericTree gt = bt.generateTree(seqList);
        date1 = new Date();
        System.out.println("Tree building Time: " + (date1.getTime() - date.getTime()));
        //System.out.print(seqList);
            //GenericTreeNode rootNode = gt.getRoot();

            //paillier = bt.encryptTree(gt);


        //SearchTree s = new SearchTree();
//            BigInteger count = s.countNumberOfSnps(paillier, columnNames, rootNode, "rs11686243=AG and rs4426491=CT and rs4666254 = CC and rs10865513=AG and rs4666258=AC");
//            BigInteger count = s.countNumberOfSnps(paillier, columnNames, rootNode, "rs4426491=CC");// and rs4305230=CC");  //and rs4666258=AC");
//            BigInteger count = s.countNumberOfSnps(pailler, columnNames, rootNode, "rs4635487=AA and rs4666258=AC");
//            BigInteger count = s.countNumberOfSnps(paillier, columnNames, rootNode, "rs4426491=CC");
//            System.out.println(paillier.Decryption(count).toString());
//            System.out.println(count);
    }
}
